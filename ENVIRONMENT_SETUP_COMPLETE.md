================================================================================
Personal AI Partner - 完全環境構築ガイド
================================================================================

このドキュメントに従って、上から順番に実行してください。
わからないことがあれば、その章で止まって質問してください。

================================================================================
【Phase 0】準備確認（5 分）
================================================================================

以下のものを準備してください：

✅ Windows PC（Mac/Linux でも同じ要領）
✅ ブラウザ（Chrome 推奨）
✅ インターネット接続
✅ ターミナル / コマンドプロンプト（後で使う）
✅ メモ帳またはエディタ（テキスト編集用）
✅ 管理者権限（インストール時に必要）

推奨スペック：
- CPU: Intel i5 相当以上
- RAM: 8GB 以上
- ストレージ: 20GB 以上の空き容量

準備できたら → Phase 1 へ

================================================================================
【Phase 1】Ollama セットアップ（30 分）
================================================================================

Ollama は「ローカル LLM」です。
これで AI（Mistral）があなたの PC で動きます。

【Step 1-1】Ollama をダウンロード

  1. ブラウザで https://ollama.ai にアクセス
  2. ページ右上または中央の「Download」をクリック
  3. Windows 版をダウンロード
     ファイル名：OllamaSetup.exe
     サイズ：約 500 MB

  ⏳ ダウンロード時間：2～5 分（Wi-Fi 速度による）

【Step 1-2】Ollama をインストール

  1. ダウンロードした OllamaSetup.exe をダブルクリック
  2. 「ユーザーアカウント制御」ダイアログが出たら「はい」をクリック
  3. インストールウィザードが起動
  4. 「Next」をクリックして進める
  5. インストール先：デフォルトのまま OK
  6. 「Install」をクリック
  7. 完了待つ（1～2 分）
  8. 「Finish」をクリック

  Ollama がバックグラウンドで自動で起動します。

【Step 1-3】PC を再起動（重要！）

  ★ これを忘れると後で「ollama: command not found」というエラーになります

  Windows キー → 「再起動」と入力 → Enter
  
  または
  
  スタート → 電源 → 再起動

  PC が再起動するまで待ってください。（1～2 分）

【Step 1-4】Ollama が正しくインストールされたか確認

  再起動後、コマンドプロンプトを開く：
  Windows キー + R → 「cmd」と入力 → Enter
  
  新しいコマンドプロンプトで以下を実行：
  
  ```
  C:\Users\yutaro> ollama --version
  ```
  
  以下のような出力が出れば OK：
  ```
  ollama version 0.1.0
  ```
  
  ❌ もし「'ollama' は、内部コマンド...」と出たら：
     → PC をもう一度再起動
     → コマンドプロンプトを新しく開く
     → もう一度試す

【Step 1-5】Mistral モデルをダウンロード

  コマンドプロンプトで以下を実行：
  
  ```
  ollama pull mistral
  ```
  
  出力例：
  ```
  pulling manifest
  pulling d2ef3a6ee1e7...
  ...
  success
  ```
  
  ⏳ ダウンロード時間：5～15 分（Wi-Fi 速度による）
  
  サイズ：2.2 GB
  
  完了するまで待ってください。

【Step 1-6】モデルがダウンロードされたか確認

  別のコマンドプロンプトで以下を実行：
  
  ```
  ollama list
  ```
  
  出力例：
  ```
  NAME            ID              SIZE
  mistral:latest  8414d6ff4130    4.1 GB
  ```
  
  mistral が表示されれば完成！

✅ Ollama セットアップ完了！

このコマンドプロンプトは閉じてしまって OK です。

================================================================================
【Phase 2】Python 環境構築（30 分）
================================================================================

Python は「プログラミング言語」です。
これで AI を制御するプログラムが動きます。

【Step 2-1】Python をダウンロード

  1. ブラウザで https://www.python.org/downloads/ にアクセス
  2. 「Download Python 3.11」をクリック
     （最新版が出ていれば 3.12 でも OK）
  3. ファイルがダウンロードされる
     ファイル名：python-3.11.x-amd64.exe
     サイズ：約 30 MB

  ⏳ ダウンロード時間：1～2 分

【Step 2-2】Python をインストール

  ★ この手順で「Add Python to PATH」にチェックが必須です！

  1. ダウンロードしたファイル（python-3.11.x-amd64.exe）をダブルクリック
  2. インストーラーが起動
  3. 画面左下の「Add python 3.11 to PATH」に ✅ チェックを入れる
  4. 「Install Now」をクリック
  5. インストール完了待つ（1～2 分）
  6. 「Close」をクリック

【Step 2-3】Python が正しくインストールされたか確認

  新しいコマンドプロンプトを開く：
  Windows キー + R → 「cmd」と入力 → Enter
  
  以下を実行：
  
  ```
  C:\Users\yutaro> python --version
  ```
  
  出力例：
  ```
  Python 3.11.7
  ```
  
  バージョンが表示されれば OK！

【Step 2-4】pip をアップグレード

  コマンドプロンプトで以下を実行：
  
  ```
  python -m pip install --upgrade pip
  ```
  
  少し待つ...
  
  出力例：
  ```
  Successfully installed pip-23.3.2
  ```

✅ Python セットアップ完了！

================================================================================
【Phase 3】プロジェクトフォルダ作成（10 分）
================================================================================

これで「作業フォルダ」を作ります。

【Step 3-1】フォルダを作成

  1. Windows エクスプローラーを開く
  2. C ドライブを開く
  3. 右クリック → 「新規作成」→「フォルダー」
  4. フォルダー名：personal-ai-code
  5. Enter キーを押す

  場所：C:\personal-ai-code

【Step 3-2】もう 1 つフォルダを作成

  1. C ドライブで右クリック → 「新規作成」→「フォルダー」
  2. フォルダー名：personal-ai-data
  3. Enter キーを押す

  場所：C:\personal-ai-data

確認：
C:\ に以下の 2 フォルダがある
  ✅ personal-ai-code
  ✅ personal-ai-data

【Step 3-3】フォルダ内に data サブフォルダを作成

  1. C:\personal-ai-data を開く
  2. 右クリック → 「新規作成」→「フォルダー」
  3. フォルダー名：data
  4. Enter

  場所：C:\personal-ai-data\data

【Step 3-4】さらに weekly フォルダを作成

  1. C:\personal-ai-data\data を開く
  2. 右クリック → 「新規作成」→「フォルダー」
  3. フォルダー名：weekly
  4. Enter

  場所：C:\personal-ai-data\data\weekly

✅ フォルダ構造完成！

================================================================================
【Phase 4】requirements.txt 作成（5 分）
================================================================================

これは「必要な Python ライブラリ一覧」です。

【Step 4-1】メモ帳を開く

  1. Windows キー + R
  2. 「notepad」と入力
  3. Enter

【Step 4-2】以下をコピー&ペースト

fastapi==0.104.1
uvicorn==0.24.0
websockets==12.0
python-dotenv==1.0.0
streamlit==1.28.0
apscheduler==3.10.0
langchain==0.1.0
chromadb==0.4.0
ollama==0.0.1
google-auth-oauthlib==1.1.0
google-auth-httplib2==0.2.0
google-api-python-client==2.100.0

【Step 4-3】保存

  1. 「ファイル」→「名前を付けて保存」
  2. 場所：C:\personal-ai-code
  3. ファイル名：requirements.txt
     （重要：.txt を付ける）
  4. 保存

✅ requirements.txt 作成完了！

================================================================================
【Phase 5】Python ファイルをダウンロード（10 分）
================================================================================

ここで僕が作成した Python ファイルを配置します。

【Step 5-1】以下の 4 ファイルを C:\personal-ai-code にコピー

  outputs フォルダから以下を C:\personal-ai-code に配置：

  ✅ backend_server.py
  ✅ frontend_ui.py
  ✅ init_chromadb.py
  ✅ dual_repo_manager.py
  ✅ gmail_extractor.py（オプション）

  確認：
  C:\personal-ai-code\ に以下がある
    ✅ backend_server.py
    ✅ frontend_ui.py
    ✅ init_chromadb.py
    ✅ dual_repo_manager.py
    ✅ requirements.txt

✅ Python ファイル配置完了！

================================================================================
【Phase 6】環境変数ファイル作成（5 分）
================================================================================

【Step 6-1】メモ帳を開く

  Windows キー + R → 「notepad」→ Enter

【Step 6-2】以下をコピー&ペースト

GMAIL_CREDENTIALS=./credentials.json

【Step 6-3】保存

  1. 「ファイル」→「名前を付けて保存」
  2. 場所：C:\personal-ai-code
  3. ファイル名：.env
     （重要：ドット env、拡張子なし）
  4. ファイルの種類：「すべてのファイル」に変更
  5. 保存

  ★ Windows では .env という名前で保存するのが難しい場合：
     
     コマンドプロンプトで以下を実行：
     ```
     cd C:\personal-ai-code
     echo GMAIL_CREDENTIALS=./credentials.json > .env
     ```

✅ .env ファイル作成完了！

================================================================================
【Phase 7】.gitignore 作成（5 分）
================================================================================

これは「GitHub に上げない」ファイルを指定します。

【Step 7-1】メモ帳を開く

  Windows キー + R → 「notepad」→ Enter

【Step 7-2】以下をコピー&ペースト

.env
credentials.json
chroma_data/
*.pyc
__pycache__/
.DS_Store
*.log

【Step 7-3】保存

  1. 「ファイル」→「名前を付けて保存」
  2. 場所：C:\personal-ai-code
  3. ファイル名：.gitignore
     （重要：ドット gitignore）
  4. ファイルの種類：「すべてのファイル」
  5. 保存

【Step 7-4】personal-ai-data にも作成

  もう一度メモ帳を開いて：

.env
credentials.json
chroma_data/
*.pyc
__pycache__/
.DS_Store
*.log

  保存：
  1. 場所：C:\personal-ai-data
  2. ファイル名：.gitignore
  3. 保存

✅ .gitignore 作成完了！

================================================================================
【Phase 8】Python ライブラリをインストール（5～10 分）
================================================================================

【Step 8-1】コマンドプロンプトを開く

  Windows キー + R → 「cmd」→ Enter

【Step 8-2】personal-ai-code に移動

  ```
  C:\Users\yutaro> cd C:\personal-ai-code
  C:\personal-ai-code>
  ```

  ★ プロンプトが C:\personal-ai-code> に変わればOK

【Step 8-3】ライブラリをインストール

  以下を実行：
  
  ```
  C:\personal-ai-code> pip install -r requirements.txt
  ```
  
  ⏳ インストール開始（3～5 分待つ）
  
  出力例：
  ```
  Collecting fastapi==0.104.1
  ...
  Successfully installed fastapi-0.104.1 uvicorn-0.24.0 ...
  ```
  
  「Successfully installed」と出れば完成！

✅ ライブラリインストール完了！

================================================================================
【Phase 9】Chromadb を初期化（5 分）
================================================================================

これで「AI の記憶」データベースを初期化します。

【Step 9-1】init_chromadb.py を実行

  コマンドプロンプト（C:\personal-ai-code）で：
  
  ```
  C:\personal-ai-code> python init_chromadb.py
  ```
  
  出力例：
  ```
  初期データを登録中...
  ✅ profile_basic を登録しました
  ✅ health_info を登録しました
  ✅ past_purchases を登録しました
  ✅ preferences を登録しました
  
  登録完了！
  コレクション内のアイテム数: 4
  ```

✅ Chromadb 初期化完了！

================================================================================
【Phase 10】テスト実行（テスト）
================================================================================

ここまで来たら、動くか試しましょう。

【Step 10-1】バックエンドサーバーを起動

  コマンドプロンプト（C:\personal-ai-code）で：
  
  ```
  C:\personal-ai-code> python backend_server.py
  ```
  
  出力例：
  ```
  INFO:     Uvicorn running on http://0.0.0.0:8000
  ```
  
  ★ このターミナルは開いたまま。Ctrl+C で止めるまで動き続けます。

【Step 10-2】サーバーが動いてるか確認

  別のコマンドプロンプトを開いて（新しいウィンドウ）：
  
  ```
  curl http://localhost:8000/health
  ```
  
  または、ブラウザで：
  http://localhost:8000/health
  
  出力例：
  ```
  {
    "status": "ok",
    "timestamp": "2025-02-24T...",
    "connected_clients": 0
  }
  ```
  
  このページが表示されればバックエンドは動いてます。

✅ バックエンドテスト完了！

================================================================================
【Phase 11】Streamlit フロントエンドを起動
================================================================================

【Step 11-1】別のコマンドプロンプトで実行

  ★ バックエンドのターミナルは閉じない！
  
  新しいコマンドプロンプトで：
  
  ```
  C:\personal-ai-code> streamlit run frontend_ui.py
  ```
  
  出力例：
  ```
  You can now view your Streamlit app in your browser.
  
  Local URL: http://localhost:8501
  ```

【Step 11-2】ブラウザでアクセス

  ブラウザを開いて：
  http://localhost:8501
  
  すると...
  
  🤖 Personal AI Partner
  
  が表示される！

✅ Streamlit テスト完了！

================================================================================
【Phase 12】動作確認（動作テスト）
================================================================================

【Step 12-1】メッセージを送信

  ブラウザで：
  
  「質問を入力してください」の欄に
  「椅子を買いたい」
  と入力して Enter または「送信」ボタンをクリック

【Step 12-2】AI が返答する

  左側のアバター：
  🤖 → 🤔 に変わる
  
  その後、返答が表示される：
  
  あなた：
  「椅子を買いたい」
  
  AI：
  「メッシュ素材の椅子がいいでしょう。
   あなたの腰痛を考慮すると...」

✅ 動作確認完了！全システム動作中！

================================================================================
【Phase 13】毎回の起動手順
================================================================================

※ 次回から毎回やること

【毎回の起動】

  ターミナル 1：
  ```
  ollama serve
  ```
  
  ターミナル 2：
  ```
  cd C:\personal-ai-code
  python backend_server.py
  ```
  
  ターミナル 3：
  ```
  cd C:\personal-ai-code
  streamlit run frontend_ui.py
  ```
  
  ブラウザ：
  http://localhost:8501

【終了時】

  各ターミナルで Ctrl+C を押す

================================================================================
【トラブルシューティング】
================================================================================

❌ Error 1: WebSocket connection failed

  症状：
  「WebSocket connection failed」と Streamlit に出る
  
  原因：
  backend_server.py が起動していない
  
  対策：
  1. ターミナル 2 を確認
  2. 「http://0.0.0.0:8000」と表示されているか確認
  3. されていなければ、もう一度実行：
     python backend_server.py

❌ Error 2: 'ollama' は、内部コマンド...

  症状：
  「'ollama' は、内部コマンドまたは外部コマンド...」
  
  原因：
  PC を再起動していない or Ollama がインストールされていない
  
  対策：
  1. PC を再起動
  2. 新しいコマンドプロンプトで ollama --version を実行

❌ Error 3: ModuleNotFoundError: No module named 'fastapi'

  症状：
  「No module named 'fastapi'」
  
  原因：
  ライブラリがインストールされていない
  
  対策：
  1. C:\personal-ai-code で以下を実行：
     pip install -r requirements.txt
  2. 完了まで待つ

❌ Error 4: Port 8000/8501 already in use

  症状：
  「Address already in use」
  
  原因：
  別のプログラムが既に使用中 or 前回のサーバーが止まっていない
  
  対策：
  1. 前のターミナルで Ctrl+C
  2. 新しいターミナルで実行

================================================================================
【GitHub セットアップ（オプション）】
================================================================================

将来的に GitHub を使いたい場合：

【Step 1】GitHub で 2 つのリポジトリを作成

  1️⃣ personal-ai-code（Public）
  2️⃣ personal-ai-data（Private）
  
  （詳細は別ドキュメント参照）

ただし、今はローカルで十分に動作確認できるので
GitHub はスキップして OK です。

================================================================================
【完了！】
================================================================================

これで全環境構築が完了しました。

✅ Ollama：AI エンジン
✅ Python：プログラミング言語
✅ FastAPI：バックエンドサーバー
✅ Streamlit：フロントエンド UI
✅ Chromadb：AI の記憶データベース

すべてが自宅 PC で動いています。

【次のステップ】

1. 毎日使ってデータを貯める
2. AI が学習する
3. 1 ヶ月後、データが増えて精度が上がる
4. 必要に応じて GitHub に移す

================================================================================
